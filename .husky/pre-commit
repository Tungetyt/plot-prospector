#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx lint-staged || { echo "Error! Code formatting or linting failed"; exit 42; }
tsc --noEmit || { echo "Error! TypeScript compilation failed"; exit 43; }
pnpm exec test run || { echo "Error! Tests failed"; exit 44; }

# Sync gitignore and eslintignore with prettierignore
echo "# WARNING: Do not modify this file manually. It is auto-generated during commit phase." > .prettierignore
cat .gitignore >> .prettierignore || { echo "Error! Failed to update .prettierignore"; exit 45; }
